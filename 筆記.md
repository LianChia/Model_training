## **1. Data_cleaning.py：圖片資料清洗與去重**

這個程式的目的是**自動找出並刪除資料夾中重複的圖片**，確保後續訓練資料乾淨、無重複。
主要流程如下：

- **讀取資料夾內所有圖片**，支援多種常見圖片格式。
- **對每張圖片計算 dHash（差異雜湊）**，這是一種將圖片內容轉成雜湊值的方法，能有效判斷圖片內容是否相似。
- **比對所有圖片的 dHash，計算 Hamming 距離**，判斷哪些圖片是重複的（Hamming 距離等於 0 時視為完全相同）。
- **將重複的圖片分組**，每組只保留創建時間最早的那一張，其餘自動刪除（連帶刪除同名的 .json 或 .npy 關聯檔）。
- **過程中會輸出進度和刪除紀錄**，最後統計總共刪除了多少重複檔案。

**簡單來說：這支程式就是幫你把一個資料夾裡的重複圖片自動找出來，只保留一份，其他全部刪掉，讓你的資料集更乾淨。**

---

## **2. class_model_1v2.py：資料載入、資料增強、模型訓練與評估**

這支程式是**深度學習二分類模型的完整訓練與評估流程**，主要針對牙科影像分類（PA、PANO）設計。
主要步驟如下：

- **資料集載入**：自訂 `DentistryDataset` 類別，會自動讀取資料夾下的圖片，並依資料夾名稱標記類別。
- **資料增強**：訓練時會對圖片做隨機裁切、翻轉、旋轉等增強，提升模型泛化能力。
- **模型架構**：自訂一個 CNN（卷積神經網路）二分類模型。
- **加權採樣**：如果資料不平衡，會自動用加權抽樣，避免模型偏向大類別。
- **損失函數**：使用 Focal Loss，對於不平衡資料集效果更好。
- **訓練流程**：支援一般訓練和 K-fold 交叉驗證。每個 epoch 都會計算訓練和驗證的 loss、accuracy。
- **Early Stopping**：如果驗證集表現一段時間沒進步，會自動提前停止訓練，避免過擬合。
- **最佳模型保存**：會自動儲存驗證集表現最好的模型權重。
- **評估**：訓練結束後，會在測試集或每個 fold 的驗證集上輸出詳細的分類報告（precision、recall、f1-score、accuracy）。

**簡單來說：這支程式會自動把資料分成訓練/驗證/測試集，做資料增強，訓練 CNN 分類模型，並用 K-fold 交叉驗證評估，最後輸出完整的分類成效報告。**

---

## **總結說明**

- **Data_cleaning.py**：先把資料集裡的重複圖片自動刪除，確保資料乾淨。
- **class_model_1v2.py**：用乾淨的資料集自動訓練與評估深度學習分類模型，過程中包含資料增強、加權取樣、early stopping、K-fold 交叉驗證等完整機制。

這兩支程式搭配起來，就是**從資料清洗到模型訓練與評估的完整流程**，適合用於有大量圖片且需要高準確率分類的專案。

